<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">

<title>
    
    Graphs &amp; C++ Warmup • ECEn 625: Compilation Strategies for High-Performance Systems
    
</title>

<!-- Bootstrap core CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

<!-- Custom styles for this template -->
<link rel="stylesheet" href=/ecen625/css/main.css>

<!-- <link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet"> -->
<!-- <link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="https://use.typekit.net/jcn6ybb.css">

<!-- <link rel="icon" type="image/png" sizes="96x96" href=/ecen625/icon/favicon-96x96.png>
<link rel="icon" type="image/png" sizes="32x32" href=/ecen625/icon/favicon-32x32.png>
<link rel="icon" type="image/png" sizes="16x16" href=/ecen625/icon/favicon-16x16.png> -->

<script src="https://kit.fontawesome.com/d794f0229e.js" crossorigin="anonymous"></script>

</head>

<body>
  <div class="d-flex" id="wrapper">
    <!-- Sidebar -->
<div class="border-right sidebar-color" id="sidebar-wrapper">
    <div class="sidebar-sticky">
        <div class="sidebar-heading-big">
            <a href="/ecen625/">
                ECEn 625</a>
        </div>
        <!-- <div class="sidebar-heading">Pages</div> -->
        <div class="list-group list-group-flush sidebar-color">
            
            
            <a href="/ecen625/overview/"
                class="sidebar-color list-item-normal list-group-item list-group-item-action sidebar-item ">
                
                <i class="fas fa-chalkboard-teacher"></i>
                
                Overview
            </a>
            
            
            
            <a href="/ecen625/lab-setup/"
                class="sidebar-color list-item-normal list-group-item list-group-item-action sidebar-item ">
                
                <i class="fas fa-wrench"></i>
                
                Lab Setup
            </a>
            
            
            
            
            
            
            
            
            
            <a href="/ecen625/links/"
                class="sidebar-color list-item-normal list-group-item list-group-item-action sidebar-item ">
                
                <i class="fas fa-box-open"></i>
                
                Links
            </a>
            
            
            
            
            
            <a href="/ecen625/paper-reviews/"
                class="sidebar-color list-item-normal list-group-item list-group-item-action sidebar-item ">
                
                <i class="fas fa-book-open"></i>
                
                Research Papers
            </a>
            
            
            
            <a href="/ecen625/schedule/"
                class="sidebar-color list-item-normal list-group-item list-group-item-action sidebar-item ">
                
                <i class="fas fa-calendar-alt"></i>
                
                Schedule
            </a>
            
            
            
            
            
            
            <a href="https://slack.com/app_redirect?team=T01J887F8MU&channel=C01JF1N6TH8"
                class="list-item-normal list-group-item list-group-item-action sidebar-item" target="_blank"><i
                    class="fa fa-question-circle"></i>
                Slack</a>
            <!-- <a href="https://learningsuite.byu.edu/.qD2F/cid-B84_MqETGWke/calendar"
                class="list-group-item list-group-item-action bg-light sidebar-item" target="_blank">
                <i class="far fa-calendar"></i>
                Schedule
            </a> -->
        </div>

        <div class="sidebar-heading">Labs</div>
        <div class="list-group list-group-flush">
            
            <a href="/ecen625/labs/lab-graphs/"
                class="list-item-normal list-group-item list-group-item-action bg-light sidebar-item">
                <span class="badge badge-pill badge-dark-grey">1</span>
                Graphs & C++ Warmup
            </a>
            
            <a href="/ecen625/labs/lab-llvm/"
                class="list-item-normal list-group-item list-group-item-action bg-light sidebar-item">
                <span class="badge badge-pill badge-dark-grey">2</span>
                LLVM
            </a>
            
            <a href="/ecen625/labs/lab-scheduling/"
                class="list-item-normal list-group-item list-group-item-action bg-light sidebar-item">
                <span class="badge badge-pill badge-dark-grey">3</span>
                Scheduling
            </a>
            
            <a href="/ecen625/labs/lab-vitis-hls/"
                class="list-item-normal list-group-item list-group-item-action bg-light sidebar-item">
                <span class="badge badge-pill badge-dark-grey">4</span>
                Vitis HLS
            </a>
            
            <a href="/ecen625/labs/lab-vitis/"
                class="list-item-normal list-group-item list-group-item-action bg-light sidebar-item">
                <span class="badge badge-pill badge-dark-grey">5</span>
                Vitis Integration
            </a>
            
            <a href="/ecen625/final-project/"
                class="list-item-normal list-group-item list-group-item-action bg-light sidebar-item">
                <i class="fa fa-microscope"></i>
                Final Project
            </a>
        </div>

        <div class="list-group list-group-flush">

        </div>

        <!-- <div class="sidebar-heading">Homeworks</div>
        <div class="list-group list-group-flush">
            
        </div> -->
    </div>
</div>
<!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">

      <nav class="navbar sticky-top navbar-expand-lg border-bottom">
        <button class="btn btn-brand" id="menu-toggle">
          <i class="fas fa-bars"></i>
        </button>

        <a href="" class="navbar-brand mb-0 h1 page-title-bar text-center mx-auto" id="page-title-bar"></a>

        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link btn btn-brand suggest-edits" target="_blank" rel="noopener noreferrer"
              href="https://github.com/byu-cpe/ecen625/issues/new?labels=website&title=Updates to Graphs & C++ Warmup page"><i
                class="fab fa-github"></i> Suggest
              Edits</a>
          </li>
        </ul>
      </nav>

      <div class="container">
        <article class="page lab">
    <h1 class="page-title" id="page-title">
        Graphs & C++ Warmup
        
        <a href="https://github.com/byu-cpe/ecen625_student/tree/main/lab_graphs" target="_blank"><i
                class="fab fa-github"></i></a>
        
    </h1>

    <div class="page-content">
        
        <div class="lab-toc col-md-6 col-lg-5 bg-light">
            <h4>Table of Contents</h4>
            <ul>
  <li><a href="#learning-outcomes">Learning Outcomes</a></li>
  <li><a href="#preliminary">Preliminary</a>
    <ul>
      <li><a href="#install-packages">Install Packages</a></li>
      <li><a href="#extract-graphs">Extract Graphs</a></li>
      <li><a href="#inspect-the-code">Inspect the code</a></li>
      <li><a href="#build-the-code">Build the code</a></li>
      <li><a href="#main">main()</a></li>
    </ul>
  </li>
  <li><a href="#requirements">Requirements</a>
    <ul>
      <li><a href="#code-checking">Code Checking</a></li>
      <li><a href="#part-1-visualizing-graphs">Part 1: Visualizing Graphs</a></li>
      <li><a href="#part-2-topological-sorting">Part 2: Topological Sorting</a></li>
      <li><a href="#part-3-longest-path">Part 3: Longest Path</a></li>
    </ul>
  </li>
  <li><a href="#deliverables">Deliverables</a></li>
  <li><a href="#submission-instructions">Submission Instructions</a></li>
</ul>

        </div>
        

        <h2 id="learning-outcomes">Learning Outcomes</h2>
<p>The goals of this assignment are to:</p>
<ul>
  <li>Familiarize yourself with graph algorithms that are most applicable to HLS techniques, namely topological sorting and identifying the critical path.</li>
  <li>Observe the structure of commercial HLS data flow graphs.</li>
  <li>Practice C++ skills.</li>
</ul>

<h2 id="preliminary">Preliminary</h2>
<p>This assignent is located in the <a href="https://github.com/byu-cpe/ecen625_student/tree/main/lab_graphs">lab_graphs</a> folder.  All commands shown assume you are located in that folder in your terminal.</p>

<h3 id="install-packages">Install Packages</h3>
<p>You will need the following packages:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt install cmake graphviz clang-12 clang-tidy-12 valgrind
</code></pre></div></div>

<h3 id="extract-graphs">Extract Graphs</h3>
<p>Due to size contraints on Github, the graphs are in a zip files and need to be extracted.  Run the following to extract the graphs:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make unzip_graphs
</code></pre></div></div>

<h3 id="inspect-the-code">Inspect the code</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">niGraphs/</code> – This folder contains 2333 graphs of customer designs from National Instrument’s HLS tool (LabVIEW Communications System Design Suite – <a href="https://www.ni.com/labview-communications/">https://www.ni.com/labview-communications/</a>).  Feel free to look at these files.  You will see each file defines a set of nodes and edges with associated properties.  As we progress through the class material you will learn more about these properties, but you can ignore most of them for now, aside from a few that are specifically mentioned in this assignment.</li>
  <li><code class="language-plaintext highlighter-rouge">src/niGraphReader/</code> – This contains the NIGraphReader class, which will parse the graph files into NIGraph* data structures.</li>
  <li><code class="language-plaintext highlighter-rouge">src/niGraph/</code> – This contains the NIGraph class, as well as NIGraphNode and NIGraphEdge classes, which are the data structures for the graphs.</li>
  <li><code class="language-plaintext highlighter-rouge">src/main.cpp</code> – You will need to implement several functions in this file.  You are free to split your code into additional files if you desire.</li>
</ul>

<h3 id="build-the-code">Build the code</h3>
<p>The project uses <code class="language-plaintext highlighter-rouge">cmake</code> as a build manager.  Cmake is a tool that will automatically create necessary makefiles for use with the <code class="language-plaintext highlighter-rouge">make</code> tool. The code can be built using the following commands:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd build
cmake ../src
make
</code></pre></div></div>

<p>This will produce an executable located in <code class="language-plaintext highlighter-rouge">build/main</code>.  If you change any file contents, you only need to re-run <code class="language-plaintext highlighter-rouge">make</code> to recompile.  If you add new files, you will need to edit the <a href="https://github.com/byu-cpe/ecen625_student/blob/main/lab_graphs/src/CMakeLists.txt">src/CMakeLists.txt</a> file.</p>

<h3 id="main">main()</h3>

<p>The provided main function can be run in two modes:</p>

<ul>
  <li><strong>Mode 1: Selective graphs</strong>: You can provide a list of graph numbers as arguments to main:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./main 1 7 1300
</code></pre></div>    </div>
    <p>For each graph this will perform topological sorting and print the sorted list of nodes, find the longest path, and generate a DOT file and PDF.  Statistics are printed to a <code class="language-plaintext highlighter-rouge">results.txt</code> file. <em>Note: Generating PDF files may not be possible for large graphs, and the program will stall.</em></p>
  </li>
  <li><strong>Mode 2: All graphs</strong>: If you provide no arguments, all graphs will be processed.  The sorted graph nodes won’t be printed, and no DOT files will be generated.</li>
</ul>

<h2 id="requirements">Requirements</h2>

<p>The goal of this lab is to perform a topological sort of a dataflow graph, identify the longest delay path, and create a graph visualization.  <a href="/ecen625/media/graphs/graph0.pdf">Graph 0</a> shows a the graph for <code class="language-plaintext highlighter-rouge">DelayGraph_0.graphml</code>. 
Your graphs should have the following properties:</p>
<ul>
  <li>Show all nodes and edges. Some nodes don’t have edges.</li>
  <li>Nodes should be labeled with the node <code class="language-plaintext highlighter-rouge">id</code>, and the longest delay path to reach the node.</li>
  <li>Edges should be labeled with the edge <code class="language-plaintext highlighter-rouge">delay</code>.</li>
  <li>Edges along the longest delay path (ie, the critical path), should be colored red.  Some edges have delay=0; these edges can optionally be included in your critical path (it doesn’t matter if you include them or not).</li>
  <li>The provided graphs are <strong><em>almost</em></strong> directed acyclic graphs (DAGs), except for a few <em>feedback edges</em>, which create cycles.  These feedback edges should be colored in blue.</li>
</ul>

<h3 id="code-checking">Code Checking</h3>
<p>In addition to completing the code functionality described above, you code should also:</p>
<ol>
  <li>Build without warnings.  I have configured <em>clang-tidy</em> to be run when you compile your code.  This will enforce some extra checking that you might have not seen in the past.  Hopefully this will help you learn more about C++ best practises and improving your coding skills.</li>
  <li>Run in Valgrind without any reported issues.</li>
</ol>

<p>These two checks are new for this year, so please reach out on Slack if you have questions.</p>

<h3 id="part-1-visualizing-graphs">Part 1: Visualizing Graphs</h3>

<p>You must write code to output an <code class="language-plaintext highlighter-rouge">NIGraph</code> structure in DOT language.  The code should be added to the following function, that you should implement in <em>solution.cpp</em>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void createDOT(const NIGraph &amp;graph, const std::string outputPath,
    NIGraphNodeList &amp;longestPath,
    std::map&lt;NIGraphNode *, int&gt; &amp;nodeDelays);
</code></pre></div></div>

<p>See <a href="https://www.graphviz.org/content/dot-language">https://www.graphviz.org/content/dot-language</a> for the specification of the DOT language.  For example, a simple DAG with two nodes (<code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">b</code>) and one edge (<code class="language-plaintext highlighter-rouge">delay = 3</code>) may have a DOT file like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strict digraph {
  a [label="a\n0"];
  b [label="b\n3"];
  a -&gt; b [label=3; color=red];  
}
</code></pre></div></div>

<p>Although the graph visualization relies on the longest path data, it is included first in this document as visualizing the graphs can sometimes be helpful in debugging your sorting or longest path analysis code.  So, I suggest you complete the graph visualization without the longest path data first, then return and finish this step once you have the longest path analysis working.</p>

<h3 id="part-2-topological-sorting">Part 2: Topological Sorting</h3>

<p>You will write code to perform a topological sort of a graph.  See lecture slides or <a href="https://en.wikipedia.org/wiki/Topological_sorting">https://en.wikipedia.org/wiki/Topological_sorting</a>.</p>

<p>The code should be implemented in this function, as part of <em>solution.cpp</em>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NIGraphNodeList topologicalSort(const NIGraph &amp;graph);
</code></pre></div></div>

<p>The function has a single input, an <code class="language-plaintext highlighter-rouge">NIGraph</code>, and returns a topologically sorted list of nodes (<code class="language-plaintext highlighter-rouge">NIGraphNode*</code>).    Since a topological sort is only possible for directed acyclic graphs (DAGs), you will need to <ins>ignore the feedback edges</ins>.</p>

<h3 id="part-3-longest-path">Part 3: Longest Path</h3>

<p>In this last section you will write code to find the longest delay path in the graph, using the topologically sorted nodes from Part 2. The code should be implemented in this function, as part of <em>solution.cpp</em>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int longestDelayPath(const NIGraphNodeList &amp;topolSortedNodes,
    NIGraphNodeList &amp;longestPath,
    std::map&lt;NIGraphNode *, int&gt; &amp;nodeDelays);
</code></pre></div></div>
<p>The first arugment to this function is the topologically sorted list of nodes in the graph.  The function populates two data structures: <code class="language-plaintext highlighter-rouge">longestPath</code> should be populated with a list of nodes that make up the longest path, from start to finish, and <code class="language-plaintext highlighter-rouge">nodeDelays</code> provides a map indicating the longest delay to each node in the graph.  The delay of the longest path is returned from the function.</p>

<p>See lecture slides, <a href="https://en.wikipedia.org/wiki/Longest_path_problem">wikipedia</a>, or search on the web for how to determine the longest path from a topological sort. For a DAG, the longest delay path is also known as the <em>critical path</em>.  This term is likely familiar to you in the circuit domain, as combinational logic can be represented using a DAG, and the critical path restricts the maximum frequency of the circuit.</p>

<p>Again, to ensure the graph is a DAG, you will \uline{need to ignore feedback edges}. Remember to ignore these edges when finding the longest back, and during the backtracking portion.</p>

<h2 id="deliverables">Deliverables</h2>

<ul>
  <li>
    <p>Make sure your code is pushed up to your Github repo.</p>
  </li>
  <li>
    <p>Add a 1 page PDF report, that includes a short paragraph about how your topological sorting algorithm works.  Include a <a href="https://en.wikipedia.org/wiki/Scatter_plot">scatter plot</a>, which plots the run-time for your topological sort code for  <strong>ALL</strong> 2333 of the provided graphs.  The plot should be of the following format:</p>
    <ul>
      <li>The x-axis should show the size of the graph (V + E)</li>
      <li>The y-axis should show the runtime of the topological sorting.</li>
      <li>Both the x and y axis should be in logarithmic scale, with appropriate ranges to fit your data points.</li>
    </ul>
  </li>
</ul>

<p>There are many ways to do a topological sort.  For full marks, your chart data should show that your algorithm complexity is approximately <code class="language-plaintext highlighter-rouge">O(V+E)</code>.  Please don’t spend extra time performing analysis to show this; a visual inspection of the scatter plot is fine.</p>

<ul>
  <li>Include the following data using your longest path code:</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Graph</th>
      <th style="text-align: right">size (V+E)</th>
      <th style="text-align: right">Delay</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">DelayGraph_0</td>
      <td style="text-align: right">197</td>
      <td style="text-align: right">8077</td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_1</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_2</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_3</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_4</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_5</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_6</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_7</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_8</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_9</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
    <tr>
      <td style="text-align: left">DelayGraph_10</td>
      <td style="text-align: right"> </td>
      <td style="text-align: right"> </td>
    </tr>
  </tbody>
</table>

<ul>
  <li>Include the longest path for DelayGraph_3.  For example, the longest path for DelayGraph_0 is:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>n0 -&gt; n14 -&gt; n15 -&gt; n19 -&gt; n21 -&gt; n23 -&gt; n24 -&gt; n25 -&gt; n26 -&gt; n27 -&gt; 
n29 -&gt; n43 -&gt; n44 -&gt; n50 -&gt; n51 -&gt; n56 -&gt; n60 -&gt; n70 -&gt; n71 -&gt; n74 -&gt; 
n75 -&gt; n78 -&gt; n76 -&gt; n77 -&gt; n79 -&gt; n80 -&gt; n81 -&gt; n82 -&gt; n83 -&gt; n84 -&gt; 
n88
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="submission-instructions">Submission Instructions</h2>

<p>Submit your code using a Github tag: <code class="language-plaintext highlighter-rouge">lab1_submission</code>.
Instructions are provided <a href="/ecen625/lab-setup/#submitting-code">here</a></p>

    </div>
</article>
      </div>
    </div>
    <!-- /#page-content-wrapper -->

  </div>
  <!-- /#wrapper -->

  <!-- Bootstrap core JavaScript -->
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>
<script src=/ecen625/js/jquery.visible.min.js></script>

<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });

    var prevVisible = $('#page-title').visible();

    $(window).scroll(function () {
        currentVisible = $('#page-title').visible()
        if (prevVisible && !currentVisible) {
            console.log("Do something!");
            $("#page-title-bar").html($('#page-title').text());
        }

        if (!prevVisible && currentVisible) {
            $("#page-title-bar").html("")
        }

        prevVisible = currentVisible;
    });

</script>

</body>

</html>